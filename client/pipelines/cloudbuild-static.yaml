# Todo add any api keys that are needed here

# Extend Timeout due to long running e2e and redundant builds
timeout: 35m0s
steps:
  - id:  Install Dependencies
    name: node:12.16.2
    dir: 'client'
    entrypoint: npm
    args: ['ci']

  - id:  Run Unit Tests
    name: node:12.16.2
    dir: 'client'
    entrypoint: npm
    args: ['test']

  - id:  Install Cypress/e2e Dependencies
    name: cypress/base:12
    dir: 'client'
    entrypoint: npm
    args: ['ci']

  - id:  Build Deployment Client Static Bundle
    name: node:12.16.2
    dir: 'client'
    entrypoint: npm
    args: ['run', 'build']
    env:
      - FIREBASE_TOKEN=$_FIREBASE_TOKEN

  - id:  Deploy static build to firebase hosting
    name: node:12.16.2
    dir: 'client'
    env:
      - FIREBASE_TOKEN=$_FIREBASE_TOKEN
    entrypoint: npm
    args: ['run', 'deploy:hosting', '--', '--token', '$_FIREBASE_TOKEN']